<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Health Registry</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #2563EB;
            --primary-dark: #1E40AF;
            --secondary-teal: #14B8A6;
            --accent-purple: #8B5CF6;
            --success-green: #10B981;
            --warning-yellow: #F59E0B;
            --error-red: #EF4444;
            --bg-primary: #F8FAFC;
            --bg-secondary: #FFFFFF;
            --bg-tertiary: #F1F5F9;
            --text-primary: #0F172A;
            --text-secondary: #475569;
            --text-muted: #94A3B8;
            --border-color: #E2E8F0;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .dark {
            --primary-blue: #3B82F6;
            --primary-dark: #2563EB;
            --secondary-teal: #14B8A6;
            --accent-purple: #A78BFA;
            --success-green: #34D399;
            --warning-yellow: #FBBF24;
            --error-red: #F87171;
            --bg-primary: #0F172A;
            --bg-secondary: #1E293B;
            --bg-tertiary: #334155;
            --text-primary: #F1F5F9;
            --text-secondary: #CBD5E1;
            --text-muted: #64748B;
            --border-color: #334155;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.6);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--accent-purple) 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .logo-text h1 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .logo-text p {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .role-selector {
            display: flex;
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 0.25rem;
            gap: 0.25rem;
        }

        .role-btn {
            padding: 0.5rem 1.25rem;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .role-btn.active {
            background: var(--bg-secondary);
            color: var(--primary-blue);
            box-shadow: var(--shadow-sm);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: var(--bg-tertiary);
            border-radius: 12px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--secondary-teal) 0%, var(--primary-blue) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .user-name {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Dashboard Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .stat-icon.blue { background: rgba(37, 99, 235, 0.1); }
        .stat-icon.green { background: rgba(16, 185, 129, 0.1); }
        .stat-icon.yellow { background: rgba(245, 158, 11, 0.1); }
        .stat-icon.red { background: rgba(239, 68, 68, 0.1); }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .stat-change {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Action Bar */
        .action-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            max-width: 400px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.75rem;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            transition: all 0.2s;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
        }

        /* Patients List */
        .patients-section {
            background: var(--bg-secondary);
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .section-header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .filter-tabs {
            display: flex;
            gap: 0.5rem;
        }

        .filter-tab {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-tab.active {
            background: var(--bg-tertiary);
            color: var(--primary-blue);
        }

        .patients-grid {
            display: grid;
            gap: 1px;
            background: var(--border-color);
        }

        .patient-card {
            background: var(--bg-secondary);
            padding: 1.5rem 2rem;
            display: grid;
            grid-template-columns: auto 1fr auto auto;
            gap: 1.5rem;
            align-items: center;
            transition: background 0.2s;
            cursor: pointer;
        }

        .patient-card:hover {
            background: var(--bg-tertiary);
        }

        .patient-avatar {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--accent-purple) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.25rem;
        }

        .patient-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .patient-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .patient-meta {
            display: flex;
            gap: 1.5rem;
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .patient-status {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            align-items: flex-end;
        }

        .mood-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.375rem 0.875rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .mood-excellent { background: rgba(16, 185, 129, 0.15); color: var(--success-green); }
        .mood-good { background: rgba(34, 197, 94, 0.15); color: #22C55E; }
        .mood-neutral { background: rgba(59, 130, 246, 0.15); color: var(--primary-blue); }
        .mood-anxious { background: rgba(245, 158, 11, 0.15); color: var(--warning-yellow); }
        .mood-poor { background: rgba(239, 68, 68, 0.15); color: var(--error-red); }

        .vital-status {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .patient-actions {
            display: flex;
            gap: 0.5rem;
        }

        .icon-btn {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 8px;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .icon-btn:hover {
            background: var(--primary-blue);
            color: white;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            animation: fadeIn 0.2s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: 20px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            animation: slideUp 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 2rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .close-btn {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 8px;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: var(--error-red);
            color: white;
        }

        .modal-body {
            padding: 2rem;
        }

        .form-grid {
            display: grid;
            gap: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-label.required::after {
            content: '*';
            color: var(--error-red);
            margin-left: 0.25rem;
        }

        .form-input,
        .form-select,
        .form-textarea {
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            transition: all 0.2s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .mood-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1rem;
        }

        .mood-option {
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-primary);
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            align-items: center;
        }

        .mood-option:hover {
            border-color: var(--primary-blue);
            transform: translateY(-2px);
        }

        .mood-option.selected {
            border-color: var(--primary-blue);
            background: rgba(37, 99, 235, 0.05);
        }

        .mood-emoji {
            font-size: 2rem;
        }

        .mood-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .vitals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .vital-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .vital-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .vital-input-wrapper {
            position: relative;
        }

        .vital-input {
            width: 100%;
            padding: 0.75rem 3rem 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            font-weight: 500;
        }

        .vital-unit {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 600;
        }

        .modal-footer {
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Patient Details View */
        .patient-header {
            display: flex;
            gap: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
        }

        .patient-header-avatar {
            width: 80px;
            height: 80px;
            border-radius: 16px;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--accent-purple) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 2rem;
        }

        .patient-header-info {
            flex: 1;
        }

        .patient-header-name {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .patient-header-meta {
            display: flex;
            gap: 2rem;
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .history-section {
            margin-top: 1.5rem;
        }

        .history-title {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .history-timeline {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .history-item {
            background: var(--bg-primary);
            padding: 1.25rem;
            border-radius: 12px;
            border-left: 4px solid var(--primary-blue);
        }

        .history-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .history-date {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .history-recorded-by {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .history-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .history-metric {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .history-metric-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .history-metric-value {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-muted);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 1.125rem;
            font-weight: 500;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .patient-card {
                grid-template-columns: auto 1fr;
                gap: 1rem;
            }

            .patient-status {
                grid-column: 1 / -1;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }

            .patient-actions {
                grid-column: 1 / -1;
                justify-content: flex-end;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .action-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .search-box {
                max-width: 100%;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .vitals-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .mood-selector {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">‚öïÔ∏è</div>
                <div class="logo-text">
                    <h1>Patient Health Registry</h1>
                    <p>Mood & Physical Status Monitoring</p>
                </div>
            </div>
            <div class="header-actions">
                <div class="role-selector">
                    <button class="role-btn active" onclick="switchRole('doctor')">üë®‚Äç‚öïÔ∏è Doctor</button>
                    <button class="role-btn" onclick="switchRole('nurse')">üë©‚Äç‚öïÔ∏è Nurse</button>
                </div>
                <div class="user-info">
                    <div class="user-avatar">DR</div>
                    <div class="user-name" id="userName">Dr. Smith</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Dashboard Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-label">Total Patients</span>
                    <div class="stat-icon blue">üë•</div>
                </div>
                <div class="stat-value" id="totalPatients">0</div>
                <div class="stat-change">Active in registry</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-label">Good Condition</span>
                    <div class="stat-icon green">üòä</div>
                </div>
                <div class="stat-value" id="goodCondition">0</div>
                <div class="stat-change">Stable vitals & mood</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-label">Needs Attention</span>
                    <div class="stat-icon yellow">‚ö†Ô∏è</div>
                </div>
                <div class="stat-value" id="needsAttention">0</div>
                <div class="stat-change">Requires monitoring</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-label">Critical</span>
                    <div class="stat-icon red">üö®</div>
                </div>
                <div class="stat-value" id="criticalCount">0</div>
                <div class="stat-change">Immediate attention</div>
            </div>
        </div>

        <!-- Action Bar -->
        <div class="action-bar">
            <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" placeholder="Search patients..." id="searchInput" oninput="searchPatients()">
            </div>
            <button class="btn btn-primary" onclick="openAddPatientModal()">
                ‚ûï Add New Patient
            </button>
        </div>

        <!-- Patients List -->
        <div class="patients-section">
            <div class="section-header">
                <h2 class="section-title">Patient Registry</h2>
                <div class="filter-tabs">
                    <button class="filter-tab active" onclick="filterPatients('all')">All</button>
                    <button class="filter-tab" onclick="filterPatients('good')">Good</button>
                    <button class="filter-tab" onclick="filterPatients('attention')">Attention</button>
                    <button class="filter-tab" onclick="filterPatients('critical')">Critical</button>
                </div>
            </div>
            <div class="patients-grid" id="patientsList">
                <div class="empty-state">
                    <div class="empty-state-icon">üìã</div>
                    <div class="empty-state-text">No patients registered yet</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Patient Modal -->
    <div class="modal" id="addPatientModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add New Patient</h2>
                <button class="close-btn" onclick="closeAddPatientModal()">‚úï</button>
            </div>
            <form onsubmit="addPatient(event)">
                <div class="modal-body">
                    <div class="form-grid">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">First Name</label>
                                <input type="text" class="form-input" id="firstName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label required">Last Name</label>
                                <input type="text" class="form-input" id="lastName" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">Patient ID</label>
                                <input type="text" class="form-input" id="patientId" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label required">Age</label>
                                <input type="number" class="form-input" id="age" min="0" max="150" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label required">Gender</label>
                                <select class="form-select" id="gender" required>
                                    <option value="">Select gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Medical History</label>
                            <textarea class="form-textarea" id="medicalHistory" placeholder="Brief medical history..."></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeAddPatientModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Patient</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Record Status Modal -->
    <div class="modal" id="recordStatusModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Record Patient Status</h2>
                <button class="close-btn" onclick="closeRecordStatusModal()">‚úï</button>
            </div>
            <form onsubmit="recordStatus(event)">
                <div class="modal-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label required">Mood Assessment</label>
                            <div class="mood-selector" id="moodSelector">
                                <div class="mood-option" onclick="selectMood(this, 'excellent')">
                                    <div class="mood-emoji">üòä</div>
                                    <div class="mood-label">Excellent</div>
                                </div>
                                <div class="mood-option" onclick="selectMood(this, 'good')">
                                    <div class="mood-emoji">üôÇ</div>
                                    <div class="mood-label">Good</div>
                                </div>
                                <div class="mood-option" onclick="selectMood(this, 'neutral')">
                                    <div class="mood-emoji">üòê</div>
                                    <div class="mood-label">Neutral</div>
                                </div>
                                <div class="mood-option" onclick="selectMood(this, 'anxious')">
                                    <div class="mood-emoji">üòü</div>
                                    <div class="mood-label">Anxious</div>
                                </div>
                                <div class="mood-option" onclick="selectMood(this, 'poor')">
                                    <div class="mood-emoji">üò¢</div>
                                    <div class="mood-label">Poor</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Vital Signs</label>
                            <div class="vitals-grid">
                                <div class="vital-input-group">
                                    <label class="vital-label">Blood Pressure</label>
                                    <div class="vital-input-wrapper">
                                        <input type="text" class="vital-input" id="bloodPressure" placeholder="120/80">
                                        <span class="vital-unit">mmHg</span>
                                    </div>
                                </div>
                                <div class="vital-input-group">
                                    <label class="vital-label">Heart Rate</label>
                                    <div class="vital-input-wrapper">
                                        <input type="number" class="vital-input" id="heartRate" placeholder="72">
                                        <span class="vital-unit">bpm</span>
                                    </div>
                                </div>
                                <div class="vital-input-group">
                                    <label class="vital-label">Temperature</label>
                                    <div class="vital-input-wrapper">
                                        <input type="number" class="vital-input" id="temperature" placeholder="98.6" step="0.1">
                                        <span class="vital-unit">¬∞F</span>
                                    </div>
                                </div>
                                <div class="vital-input-group">
                                    <label class="vital-label">Oxygen Level</label>
                                    <div class="vital-input-wrapper">
                                        <input type="number" class="vital-input" id="oxygenLevel" placeholder="98" min="0" max="100">
                                        <span class="vital-unit">%</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Pain Level (0-10)</label>
                            <input type="range" class="form-input" id="painLevel" min="0" max="10" value="0" oninput="updatePainValue(this.value)">
                            <div style="text-align: center; font-weight: 600; color: var(--text-primary);">
                                <span id="painValue">0</span> / 10
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Symptoms</label>
                            <textarea class="form-textarea" id="symptoms" placeholder="List any symptoms observed..."></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Clinical Notes</label>
                            <textarea class="form-textarea" id="clinicalNotes" placeholder="Additional observations and notes..."></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeRecordStatusModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Record</button>
                </div>
            </form>
        </div>
    </div>

    <!-- View Patient Modal -->
    <div class="modal" id="viewPatientModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Patient Details</h2>
                <button class="close-btn" onclick="closeViewPatientModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="patient-header" id="patientDetailsHeader"></div>
                <div class="history-section">
                    <h3 class="history-title">Medical History & Records</h3>
                    <div class="history-timeline" id="patientHistory"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeViewPatientModal()">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        let patients = [];
        let currentRole = 'doctor';
        let currentFilter = 'all';
        let selectedMood = null;
        let currentPatientId = null;

        function switchRole(role) {
            currentRole = role;
            document.querySelectorAll('.role-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            if (role === 'doctor') {
                document.getElementById('userName').textContent = 'Dr. Smith';
            } else {
                document.getElementById('userName').textContent = 'Nurse Johnson';
            }
        }

        function updateStats() {
            const total = patients.length;
            const good = patients.filter(p => p.records.length > 0 &&
                ['excellent', 'good'].includes(p.records[0].mood)).length;
            const attention = patients.filter(p => p.records.length > 0 &&
                ['neutral', 'anxious'].includes(p.records[0].mood)).length;
            const critical = patients.filter(p => p.records.length > 0 &&
                p.records[0].mood === 'poor').length;

            document.getElementById('totalPatients').textContent = total;
            document.getElementById('goodCondition').textContent = good;
            document.getElementById('needsAttention').textContent = attention;
            document.getElementById('criticalCount').textContent = critical;
        }

        function openAddPatientModal() {
            document.getElementById('addPatientModal').classList.add('active');
        }

        function closeAddPatientModal() {
            document.getElementById('addPatientModal').classList.remove('active');
            document.querySelector('#addPatientModal form').reset();
        }

        function addPatient(event) {
            event.preventDefault();

            const patient = {
                id: Date.now(),
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                patientId: document.getElementById('patientId').value,
                age: document.getElementById('age').value,
                gender: document.getElementById('gender').value,
                medicalHistory: document.getElementById('medicalHistory').value,
                records: [],
                createdAt: new Date().toISOString(),
                createdBy: currentRole === 'doctor' ? 'Dr. Smith' : 'Nurse Johnson'
            };

            patients.unshift(patient);
            renderPatients();
            updateStats();
            closeAddPatientModal();
            showNotification('Patient added successfully!');
        }

        function renderPatients() {
            let filteredPatients = patients;

            if (currentFilter === 'good') {
                filteredPatients = patients.filter(p => p.records.length > 0 &&
                    ['excellent', 'good'].includes(p.records[0].mood));
            } else if (currentFilter === 'attention') {
                filteredPatients = patients.filter(p => p.records.length > 0 &&
                    ['neutral', 'anxious'].includes(p.records[0].mood));
            } else if (currentFilter === 'critical') {
                filteredPatients = patients.filter(p => p.records.length > 0 &&
                    p.records[0].mood === 'poor');
            }

            const container = document.getElementById('patientsList');

            if (filteredPatients.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <div class="empty-state-text">No patients found</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredPatients.map(patient => {
                const latestRecord = patient.records[0];
                const initials = patient.firstName[0] + patient.lastName[0];
                const moodClass = latestRecord ? `mood-${latestRecord.mood}` : 'mood-neutral';
                const moodText = latestRecord ? latestRecord.mood.charAt(0).toUpperCase() + latestRecord.mood.slice(1) : 'No data';
                const vitalText = latestRecord ? `BP: ${latestRecord.bloodPressure || 'N/A'}, HR: ${latestRecord.heartRate || 'N/A'} bpm` : 'No vitals recorded';

                return `
                    <div class="patient-card" onclick="viewPatient(${patient.id})">
                        <div class="patient-avatar">${initials}</div>
                        <div class="patient-info">
                            <div class="patient-name">${patient.firstName} ${patient.lastName}</div>
                            <div class="patient-meta">
                                <span>ID: ${patient.patientId}</span>
                                <span>${patient.age}y, ${patient.gender}</span>
                                <span>${patient.records.length} record(s)</span>
                            </div>
                        </div>
                        <div class="patient-status">
                            <div class="mood-indicator ${moodClass}">
                                ${getMoodEmoji(latestRecord?.mood)} ${moodText}
                            </div>
                            <div class="vital-status">${vitalText}</div>
                        </div>
                        <div class="patient-actions">
                            <button class="icon-btn" onclick="event.stopPropagation(); openRecordStatusModal(${patient.id})" title="Record Status">üìù</button>
                            <button class="icon-btn" onclick="event.stopPropagation(); viewPatient(${patient.id})" title="View Details">üëÅÔ∏è</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getMoodEmoji(mood) {
            const emojis = {
                excellent: 'üòä',
                good: 'üôÇ',
                neutral: 'üòê',
                anxious: 'üòü',
                poor: 'üò¢'
            };
            return emojis[mood] || 'üòê';
        }

        function filterPatients(filter) {
            currentFilter = filter;
            document.querySelectorAll('.filter-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderPatients();
        }

        function searchPatients() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const filtered = patients.filter(p =>
                p.firstName.toLowerCase().includes(query) ||
                p.lastName.toLowerCase().includes(query) ||
                p.patientId.toLowerCase().includes(query)
            );

            const container = document.getElementById('patientsList');
            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîç</div>
                        <div class="empty-state-text">No patients found matching "${query}"</div>
                    </div>
                `;
            } else {
                currentFilter = 'all';
                patients = [...patients];
                patients.unshift(...filtered.splice(0));
                renderPatients();
            }
        }

        function openRecordStatusModal(patientId) {
            currentPatientId = patientId;
            selectedMood = null;
            document.querySelectorAll('.mood-option').forEach(opt => opt.classList.remove('selected'));
            document.getElementById('recordStatusModal').classList.add('active');
        }

        function closeRecordStatusModal() {
            document.getElementById('recordStatusModal').classList.remove('active');
            document.querySelector('#recordStatusModal form').reset();
            currentPatientId = null;
            selectedMood = null;
        }

        function selectMood(element, mood) {
            document.querySelectorAll('.mood-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            selectedMood = mood;
        }

        function updatePainValue(value) {
            document.getElementById('painValue').textContent = value;
        }

        function recordStatus(event) {
            event.preventDefault();

            if (!selectedMood) {
                showNotification('Please select a mood assessment', 'error');
                return;
            }

            const patient = patients.find(p => p.id === currentPatientId);
            if (!patient) return;

            const record = {
                id: Date.now(),
                mood: selectedMood,
                bloodPressure: document.getElementById('bloodPressure').value,
                heartRate: document.getElementById('heartRate').value,
                temperature: document.getElementById('temperature').value,
                oxygenLevel: document.getElementById('oxygenLevel').value,
                painLevel: document.getElementById('painLevel').value,
                symptoms: document.getElementById('symptoms').value,
                clinicalNotes: document.getElementById('clinicalNotes').value,
                recordedAt: new Date().toISOString(),
                recordedBy: currentRole === 'doctor' ? 'Dr. Smith' : 'Nurse Johnson'
            };

            patient.records.unshift(record);
            renderPatients();
            updateStats();
            closeRecordStatusModal();
            showNotification('Patient status recorded successfully!');
        }

        function viewPatient(patientId) {
            const patient = patients.find(p => p.id === patientId);
            if (!patient) return;

            const initials = patient.firstName[0] + patient.lastName[0];
            document.getElementById('patientDetailsHeader').innerHTML = `
                <div class="patient-header-avatar">${initials}</div>
                <div class="patient-header-info">
                    <h3 class="patient-header-name">${patient.firstName} ${patient.lastName}</h3>
                    <div class="patient-header-meta">
                        <span>üìã ID: ${patient.patientId}</span>
                        <span>üéÇ Age: ${patient.age}</span>
                        <span>‚öß Gender: ${patient.gender}</span>
                        <span>üìÖ Registered: ${new Date(patient.createdAt).toLocaleDateString()}</span>
                    </div>
                    ${patient.medicalHistory ? `<p style="margin-top: 0.75rem; color: var(--text-secondary);">${patient.medicalHistory}</p>` : ''}
                </div>
            `;

            const historyContainer = document.getElementById('patientHistory');
            if (patient.records.length === 0) {
                historyContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìä</div>
                        <div class="empty-state-text">No medical records yet</div>
                    </div>
                `;
            } else {
                historyContainer.innerHTML = patient.records.map(record => `
                    <div class="history-item">
                        <div class="history-item-header">
                            <span class="history-date">${new Date(record.recordedAt).toLocaleString()}</span>
                            <span class="history-recorded-by">Recorded by: ${record.recordedBy}</span>
                        </div>
                        <div class="history-content">
                            <div class="history-metric">
                                <span class="history-metric-label">Mood</span>
                                <span class="history-metric-value">${getMoodEmoji(record.mood)} ${record.mood.charAt(0).toUpperCase() + record.mood.slice(1)}</span>
                            </div>
                            ${record.bloodPressure ? `
                                <div class="history-metric">
                                    <span class="history-metric-label">Blood Pressure</span>
                                    <span class="history-metric-value">${record.bloodPressure} mmHg</span>
                                </div>
                            ` : ''}
                            ${record.heartRate ? `
                                <div class="history-metric">
                                    <span class="history-metric-label">Heart Rate</span>
                                    <span class="history-metric-value">${record.heartRate} bpm</span>
                                </div>
                            ` : ''}
                            ${record.temperature ? `
                                <div class="history-metric">
                                    <span class="history-metric-label">Temperature</span>
                                    <span class="history-metric-value">${record.temperature}¬∞F</span>
                                </div>
                            ` : ''}
                            ${record.oxygenLevel ? `
                                <div class="history-metric">
                                    <span class="history-metric-label">Oxygen Level</span>
                                    <span class="history-metric-value">${record.oxygenLevel}%</span>
                                </div>
                            ` : ''}
                            <div class="history-metric">
                                <span class="history-metric-label">Pain Level</span>
                                <span class="history-metric-value">${record.painLevel}/10</span>
                            </div>
                        </div>
                        ${record.symptoms ? `<p style="margin-top: 1rem; color: var(--text-secondary);"><strong>Symptoms:</strong> ${record.symptoms}</p>` : ''}
                        ${record.clinicalNotes ? `<p style="margin-top: 0.5rem; color: var(--text-secondary);"><strong>Notes:</strong> ${record.clinicalNotes}</p>` : ''}
                    </div>
                `).join('');
            }

            document.getElementById('viewPatientModal').classList.add('active');
        }

        function closeViewPatientModal() {
            document.getElementById('viewPatientModal').classList.remove('active');
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'var(--success-green)' : 'var(--error-red)'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 12px;
                font-weight: 600;
                box-shadow: var(--shadow-lg);
                z-index: 2000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        // Close modals on outside click
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // Initial render
        updateStats();
        renderPatients();
    </script>
</body>
</html>
